FROM jupyterhub/singleuser

USER root

RUN apt-get update && apt-get -y install git

USER jovyan

RUN /opt/conda/bin/pip install jupyterhub==0.7.2

RUN /opt/conda/bin/pip install jupyterlab==0.32.1

RUN  /opt/conda/bin/pip install git+https://github.com/girder/girder_jupyterhub.git@master

RUN  /opt/conda/bin/pip install git+https://github.com/girder/girder_jupyter.git@master

RUN  git clone https://github.com/OpenChemistry/openchemistrypy.git openchemistrypy && \
  /opt/conda/bin/pip install -e openchemistrypy

RUN  git clone https://github.com/cjh1/jupyterlab_cjson.git && \
  cd jupyterlab_cjson && \
  /opt/conda/bin/pip install -e . && \
  cd labextension && \
  npm install && \
  npm run build && \
  jupyter labextension link .
